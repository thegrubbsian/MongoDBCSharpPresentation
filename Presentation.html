<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <!-- Slide meta data, remove/edit as you see fit -->
        <title>Intro to MongoDB</title>
        <!-- Slippy core file and dependencies -->
        <script type="text/javascript" src="slippy/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="slippy/jquery.history.js"></script>
        <script type="text/javascript" src="slippy/slippy-0.9.0.js"></script>
        <!-- Slippy structural styles -->
		<link type="text/css" rel="stylesheet" href="slippy/reset.css"/>
        <link type="text/css" rel="stylesheet" href="slippy/slippy-0.9.0.css"/>
        <!-- Slippy theme -->
        <link type="text/css" rel="stylesheet" href="slippy/slippy-dark.css"/>
        <!-- Syntax highlighting core file  -->
        <script type="text/javascript" src="slippy/highlighter/shCore.js"></script>
        <!-- Syntax highlighting brushes, remove those you don't need -->
        <script type="text/javascript" src="slippy/highlighter/shBrushBash.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushCpp.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushCSharp.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushCss.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushDelphi.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushDiff.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushGroovy.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushJava.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushJScript.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushPhp.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushPlain.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushPython.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushRuby.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushScala.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushSql.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushVb.js"></script>
        <script type="text/javascript" src="slippy/highlighter/shBrushXml.js"></script>
        <!-- Syntax highlighting styles-->
        <link type="text/css" rel="stylesheet" href="slippy/highlighter/shCore.css"/>
        <link type="text/css" rel="stylesheet" href="slippy/highlighter/shThemeEclipse.css"/>
        <!-- Slippy init code -->
        <script type="text/javascript">
            $(function() {
                $(".slide").slippy();
                SyntaxHighlighter.all();
            });
        </script>
    </head>
    <body>
	
		<div class="slide">
			<div class="vcenter">
				<h1 class="title"><div class="margin-bottom: 10px;">An Introduction to</div> <img src="Images/mongodb.png" /></h1>
				<h4 class="text-center">JC Grubbs</h4>
				<h4 class="text-center">http://www.thegrubbsian.com</h4>
				<h4 class="text-center">@thegrubbsian on the Twitter</h4>
			</div>
		</div>
		
		
		
		<div class="slide">
			<h1>What is this "NoSQL" thing?</h1>
			<p>
				NoSQL is an umbrella term which describes a variety of non-relational database approaches.  Most
				databases in this class fall into one of the following categories:
			</p>
			<ul>
				<li>Object Databases (DB40, Matisse)</li>
				<li>Key-Value Stores (Reddis, Tokyo Cabinet)</li>
				<li>Document Databases (CouchDB, MongoDB, RavenDB)</li>
				<li>Column Family (Google BigTable, Cassandra)</li>
				<li>Graph Databases (Neo4j)</li>
			</ul>
			<br/>
			<p>There are many others, but they are all trying to solve essentially the same problems:</p>
			<ul>
				<li>Horizontal Scaling and Distribution</li>
				<li>Developer Productivity</li>
				<li>Trade Performance for Complexity</li>
			</ul>
		</div>
	
	
	
        <div class="slide">
            <h1>What is MongoDB</h1>
            <ul>
                <li>Schema Free</li>
				<li>Document Oriented</li>
				<li>High Performance</li>
				<li>Scalable</li>
				<li>Multi-Platform</li>
            </ul>
			<br/><br/>
            <h1>What MongoDB is Not</h1>
            <ul>
                <li>Key/Value Store</li>
				<li>Relational</li>
				<li>Fully ACID Compliant</li>
            </ul>
        </div>



		<div class="slide">
			<h1>Who's Using It</h1>
			<div class="floating-images">
				<table>
					<tr>
						<td>
							<img src="Images/foursquare.png"/>
							<img src="Images/evite.png"/>
							<img src="Images/gh.png"/>
							<img src="Images/logo-disqus.png"/>
						</td>
					</tr>
					<tr>
						<td>
							<img src="Images/logo-mogohq.png"/>
							<img src="Images/logo-times.gif"/>
							<img src="Images/squarespace.jpeg"/>
						</td>
					</tr>
					<tr>
						<td>
							<img src="Images/sugar.gif"/>
							<img src="Images/crew-logo.png"/>
							<img src="Images/logo-justin_tv.png"/>
						</td>
					</tr>
					<tr>
						<td>
							<img src="Images/bitly.png"/>
							<img src="Images/logo-sourceforge.png"/>
							<img src="Images/shutterfly.jpeg"/>
							<img src="Images/logo-floxee.png"/>
						</td>
					</tr>
				</table>
			</div>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Production+Deployments">http://www.mongodb.org/display/DOCS/Production+Deployments</a>
		</div>


		
		<div class="slide">
			<h1>Use Cases</h1>
			<p>You might want to consider MongoDB if:</p>
			<ul>
				<li>You're dealing with document/nested style data.</li>
				<li>You'd rather scale horizontally than get a bigger server.</li>
				<li>You have a rapid write scenario.</li>
				<li>Your data is dynamic in some way.</li>
				<li>You can live with relaxed ACID compliance (BASE).</li>
			</ul>
		</div>
		
		
		
		<div class="slide">
			<h1>Anti-Use Cases</h1>
			<p>You probably don't want to use MongoDB if:</p>
			<ul>
				<li>Your domain is inherently relational and nested structures don't make sense.</li>
				<li>You have complicated reporting needs.</li>
				<li>You need 100% ACID compliance.</li>
				<li>You require traditional transactions over multiple collections/tables.</li>
				<li>Your DBA is an old school curmudgeon.</li>
			</ul>
		</div>
		
		
		
		<div class="slide">
			<h1>A Few Usage Scenarios</h1>
			<img src="Images/usage-scenarios.png" class="inline-image" />
			<p>
				Because MongoDB is so flexible and deployment/install is so simple, it lends itself
				to a number of potential use cases for scaling and optimization.
			</p>
		</div>
		
		
		
		<div class="slide">
			<h1>MongoDB Server</h1>
			<ul>
				<li>The MongoDB server runs as a console or daemon/service.</li>
				<li>The server will use one thread per TCP connection.</li>
				<li>Most drivers implement some kind of connection pooling, this is the recommended use.</li>
				<li>Data is stored in two files on disk.  The default location is '/data/db' but can be changed.</li>
				<li>While the server runs it manages a memory mapped file per database.</li>
				<li>Mongo will consume as much memory as makes sense but will gracefully handle lower memory situations.</li>
			</ul>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Connections">http://www.mongodb.org/display/DOCS/Connections</a>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Starting+and+Stopping+Mongo">http://www.mongodb.org/display/DOCS/Starting+and+Stopping+Mongo</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Documents and Collections</h1>
			<p>MongoDB stores data in documents.  Think of them as JSON structures.</p>
			<pre class="brush:js">
				{
					OrderNumber: 123,
					OrderDate: new Date(2010,1,1),
					Items: [
						{ SKU: 12345, Name: "Hammer" },
						{ SKU: 54321, Name: "Box of Nails" },
						{ SKU: 13579, Name: "Pine Planks" }
					],
					CreditCard: {
						Type: "Visa",
						Number: 1234123412341234,
						Expiration: new Date(2011,7,1)
					}
				}
			</pre>
			<ul>
				<li>Collections are just named sets of root documents.</li>
				<li>You might equate a document with a row and collections with tables.</li>
				<li>Collections can contain documents of varying shapes.</li>
				<li>Individual documents may not exceed 4Mb in size.</li>
			</ul>
		</div>



		<div class="slide">
            <h1>BSON</h1>
			<p>MongoDB stores data in BSON, which is a JSON-like binary format.</p>
			<pre class="brush:text">
				{"hello": "world"}
				
				"\x16\x00\x00\x00\x02hello\x00
				\x06\x00\x00\x00world\x00\x00"
			</pre>
			<pre class="brush:text">
				{"SomeArray": ["awesome", 5.05, 1986]}
				
				"1\x00\x00\x00\x04SomeArray\x00&\x00
				 \x00\x00\x020\x00\x08\x00\x00 
				 \x00awesome\x00\x011\x00333333
				 \x14@\x102\x00\xc2\x07\x00\x00
				 \x00\x00"
			</pre>
			<a class="doclink" href="http://bsonspec.org">http://bsonspec.org</a>
			<br/>
			<ul>
				<li>Serialization and deserialization of data structures occurs in the language drivers, not on the server itself.</li>
				<li>Each driver may implement the BSON specification in a manner that is most efficient for that platform.</li>
			</ul>
			
        </div>



		<div class="slide">
			<h1>Document Identity</h1>
			<ul>
				<li>Every root document must have an <code>_id</code> property.</li>
				<li>MongoDB implements a special BSON type called ObjectId to uniquely identify documents.</li>
				<li>You can use types other than ObjectId for the <code>_id</code> property.</li>
				<li>If you do not assign a value for <code>_id</code> the database will create the attribute for you.</li>
			</ul>
			<br/><br/>
			<p>ObjectId is a 12-byte unique identifier made up of the following:</p>
			<table class="table"> 
			<tbody><tr><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td>
			<td>7</td><td>8</td><td>9</td><td>10</td><td>11</td></tr> 
			<tr><td colspan="4">time</td><td colspan="3">machine</td> 
			<td colspan="2">pid</td><td colspan="3">inc</td></tr> 
			</tbody></table>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Object+IDs">http://www.mongodb.org/display/DOCS/Object+IDs</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Commands and the Shell</h1>
			<ul>
				<li>Commands are issued to the server as MongoDB documents.</li>
				<li>MongoDB comes with an interactive JavaScript based shell that is the easiest
				way to interact with the database for development and administration.</li>
			</ul>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/mongo+-+The+Interactive+Shell">http://www.mongodb.org/display/DOCS/mongo+-+The+Interactive+Shell</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Query Syntax</h1>
			<p>
				MongoDB has a unique but powerful query syntax.  Even so, most of the language
				drivers abstract it in some way.
			</p>
			<pre class="brush:js">
				// where first name is 'Bill'
				db.User.find({ FirstName: "Bill" });
				
				// where first name is 'Bill' return only _id and LastName
				db.User.find({ FirstName: "Bill" }, { _id: 1, LastName: 1 });
				
				// where age is greater than 35
				db.User.find({ Age: { $gt: 35 } });
				
				// where department's director is 'John'
				db.User.find({ "Department.Director.FirstName": "John" });
				
				// sort by last name ascending and first name descending
				db.User.find().sort({ LastName: 1, FirstName: -1 });
			</pre>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Querying">http://www.mongodb.org/display/DOCS/Querying</a>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart">http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Query Syntax (cont.)</h1>
			<pre class="brush:js">
				// limiting results
				db.User.find({ Age: { $gt: 5 } }).skip(20).limit(10);
				db.User.find({ Age: { $gt: 5 } }, 20, 10);
				
				// return the count of a query
				db.User.find({ "Department.Name": "IT" }).count();
				
				// return a distinct list of a single value
				db.User.distinct("LastName");
				
				// check the existence of at least one document
				db.User.find({ Username: { $exists: "sbarrows" } });
				
				// check if a value is in a list
				db.User.find({ "Department.Number": { $in: [75,22,34,102] } });
			</pre>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Advanced+Queries">http://www.mongodb.org/display/DOCS/Advanced+Queries</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Query Syntax (cont. again)</h1>
			<pre class="brush:js">
				// inserting a new document
				db.User.save({ FirstName: "William", LastName: "Edwards" });
				
				// updating a property of a document
				db.User.update({ LastName: "Edwards" }, { FirstName: "Bill" });
				
				// deleting a document
				db.User.remove({ Age: { $lt: 35 } });
				
				// using functions to locate documents (won't use indexes)
				db.User.find(function () { return this.Department.Name == "IT"; });
				
				// return only the first n for a child array
				db.User.find({}, { PreviousJobs: { $slice: 5 } });
			</pre>
		</div>
		
		
		
		<div class="slide">
			<h1>Indexing</h1>
			<ul>
				<li>Supports basic indexing scenarios you might find in a relational store.</li>
				<li>Indices are stored as document references in a simple b-tree structure.</li>
				<li>Indices can be created on embedded documents.</li>
				<li>An index on an embedded array will index each item in the array. (Very powerful especially with sparse attributes).</li>
				<li>Supports geospatial indexing which enables additional query operators.</li>
			</ul>
			
			<br/><br/>
			
			<h3>Current Limitations</h3>
			<ul>
				<li>A collection can only have 40 indices defined.</li>
				<li>Queries only use one index at a time.</li>
				<li>Map/Reduce does not use indices.</li>
				<li>Most RegEx queries will not use an index.</li>
			</ul>
			
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Indexes">http://www.mongodb.org/display/DOCS/Indexes</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Indexing (cont.)</h1>
			<pre class="brush:js">
				// create an index on the Username attribute
				db.User.ensureIndex({ Username: 1 });
				
				// create a unique index on the Username attribute
				db.User.ensureIndex({ Username: 1 }, { unique: true });
				
				// create a multi-attribute index
				db.User.ensureIndex({ Username: 1, "Department.ID": 1 });
				
				// rebuilding an index
				db.User.reIndex();
				
				// dropping an index
				db.User.dropIndexes();
				db.User.dropIndex({ Username: 1 })
			</pre>
		</div>
		
		
		
		<div class="slide">
			<h1>Map/Reduce</h1>
			<p>
				In MongoDB Map/Reduce works by taking map and reduce functions and generating
				a new collection.  This collection can be temporary or be made permanent.
			</p>
			<pre class="brush:js">
				var m = function () { 
					this.Tags.forEach(function (t) { 
						emit(t, { count: 1 });
					});
				};
				var r = function (k, v) {
					var total = 0;
					for (var i = 0; i < v.length; i++) {
						total += v[i].count;
					}
					return { count: total }
				};
				var mr = db.Posts.mapReduce(m, r);
				db[mr.result].find();
			</pre>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/MapReduce">http://www.mongodb.org/display/DOCS/MapReduce</a>
		</div>
		
		
		
		<div class="slide">
			<h1>GridFS</h1>
			<ul>
				<li>Provides a way to store large binary data across multiple documents.</li>
				<li>Allows for range operations, such as fetching the first N bytes.</li>
				<li>Works by creating a meta-data collection, and then N file collections.</li>
				<li>Like BSON, GridFS is implemented in the driver and supported by the server.</li>
			</ul>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/GridFS+Specification">GridFS Specification</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Performance</h1>
			<p>Here are some potentially controversial performance graphs comparing MongoDB with SQL Server.  Regardless, it's freaking fast!</p>
			<img src="Images/perf_inserts.png" style="width: 12em;" />
			<img src="Images/perf_queries.png" style="width: 12em;">
			<br />
			<a class="doclink" href="http://www.michaelckennedy.net/blog/2010/04/29/MongoDBVsSQLServer2008PerformanceShowdown.aspx">http://www.michaelckennedy.net/blog/2010/04/29/MongoDBVsSQLServer2008PerformanceShowdown.aspx</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Import/Export/Backup</h1>
			<p>The MongoDB distribution comes with the following administrative tools:</p>
			<ul>
				<li>mongoimport: Imports a collection into MongoDB from JSON or CSV formats.</li>
				<li>mongoexport: Exports a collection from MongoDB to JSON or CSV format.</li>
				<li>mongodump: Dumps an entire database or collection in binary format.</li>
				<li>mongorestore: Restores the contents of a mongodump file to a database.</li>
				<li>copyDatabase Command: Copys a database from one server to another.</li>
			</ul>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Import+Export+Tools">http://www.mongodb.org/display/DOCS/Import+Export+Tools</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Replication</h1>
			<ul>
				<li>MongoDB supports replication in two configurations: Master/Slave and Replica Pairs.</li>
				<li>Only the master is active for writes though which database is the master can be changed at will.</li>
				<li>Replicating data to the slave databases can be done with a delay if desired.</li>
			</ul>
			<p>Setting up basic replication is extremely easy:</p>
			<pre class="brush:js">
				// start the master
				mongod --master
				
				// start the slave
				mongod --slave --source localhost:27017
			</pre>
			<p>There are a number of other configuration options for delayed replication, etc.</p>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Replication">http://www.mongodb.org/display/DOCS/Replication</a>
		</div>
		
		
		
		<div class="slide">
			<h1>Sharding</h1>
			<div class="vcenter text-center">Available in alpha now, releasing in next major version.</div>
		</div>
		
		
		
		<div class="slide">
			<h1>Profiling</h1>
			<p>Enable profiling from the shell:</p>
			<pre class="brush:js">
				// profiling levels: 
				// 0 = off
				// 1 = operations > 100ms
				// 2 = all operations
				db.setProfilingLevel(2);
			</pre>
			<p>
				The profiling logs to the <code>system.profile</code> collection and you can perform
				any query against the documents in this collection.
			</p>
		</div>
		
		
		
		<div class="slide">
			<h1>Support</h1>
			<img src="Images/10gen.png" class="inline-image" style="width: 5em;" />
			<br/><br/>
			<ul>
				<li>The open source development of MongoDB is funded by 10gen who also offer commercial support, training, and consulting.</li>  
				<li>The mailing list is extremely active and getting free community support is usually very easy.</li>  
				<li>Documentation is fairly extensive at <a href="http://www.mongodb.org">mongodb.org</a>.</li>
			</ul>
		</div>
		
		
		
		<div class="slide">
			<h1>Language Drivers</h1>
			<p>
				Here are a few of the drivers available but there are many more for languages and platforms 
				including Scala, Clojure, Erlang, Smalltalk, and many more.
			</p>
			<table class="table">
				<tbody>
					<tr>
						<td>.NET</td>
						<td>JVM</td>
						<td>Ruby</td>
						<td>Python</td>
						<td>JavaScript</td>
					</tr>
					<tr>
						<td><a href="http://github.com/samus/mongodb-csharp/tree/master">mongodb-csharp</a></td>
						<td><a href="http://github.com/mongodb/mongo-java-driver/downloads">mongo-java-driver</a></td>
						<td><a href="http://railstips.org/2009/6/27/mongomapper-the-rad-mongo-wrapper">MongoMapper</a></td>
						<td><a href="http://github.com/jeffjenkins/mongo-mapper/tree/master">mongo-mapper</a></td>
						<td><a href="http://www.learnboost.com/mongoose/">Mongoose</a><br/>(node.js)</td>
					</tr>
					<tr>
						<td><a href="http://code.google.com/p/simple-mongodb/">simple-mongodb</a></td>
						<td></td>
						<td><a href="http://github.com/tmm1/rmongo">rmongo</a></td>
						<td><a href="http://bitbucket.org/bottiger/mongomagic/wiki/Home">MongoMagic</a></td>
						<td><a href="http://github.com/sergi/narwhal-mongodb">narwhal-mongodb</a></td>
					</tr>
					<tr>
						<td><a href="http://github.com/atheken/NoRM">NoRM</a></td>
						<td></td>
						<td><a href="http://mongoid.org/">Mongoid</a></td>
						<td><a href="http://bitbucket.org/kpot/django-mongodb/">django-mongodb</a></td>
						<td></td>
					</tr>
				</tbody>
			</table>
			<a class="doclink" href="http://www.mongodb.org/display/DOCS/Drivers">http://www.mongodb.org/display/DOCS/Drivers</a>
		</div>
		
		
		
		<div class="slide">
			<h1>NoRM</h1>
			<img src="Images/normLogo.png" style="width: 10em;">
			<p>NoRM is a .NET library for interacting with MongoDB; it provides the following:</p>
			<ul>
				<li>Strongly Typed Collection Abstraction</li>
				<li>Complete LINQ Provider for MongoDB Queries</li>
				<li>Connection Pooling</li>
				<li>High Performance BSON Serializer</li>
				<li>An Expando Implementation for Dynamic Data</li>
				<li>Configuration API for Collection/Property Aliasing</li>
			</ul>
		</div>
		
		

		<div class="slide">
			<h1 class="vcenter">}</h1>
		</div>



        <div class="footer">
			<span class="right"><a href="http://www.mongodb.org">mongodb.org</a></span>
            <span class="left">An Introduction to MongoDB</span>
			<span class="right"><a href="http://github.com/thegrubbsian/MongoDBPresentation">github.com/thegrubbsian/MongoDBPresentation</a></span>
            <span class="left">JC Grubbs</span>
            <hr class="defloat" />
        </div>
    </body>
</html>